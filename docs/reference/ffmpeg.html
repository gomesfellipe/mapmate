<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Make video from still image sequence — ffmpeg • mapmate</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  
<meta property="og:title" content="Make video from still image sequence — ffmpeg" />

<meta property="og:description" content="Make a video file from a sequence of still images using FFmpeg." />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mapmate</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
    Home
  </a>
</li>
<li>
  <a href="../articles/mapmate.html">
    <span class="fa fa-info fa-lg"></span>
     
    Introduction
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-globe fa-lg"></span>
     
    Visual examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/usage_and_limitations.html">Usage &amp; limitations</a>
    </li>
    <li>
      <a href="../articles/networks.html">Network maps</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/ffmpeg.html">
    <span class="fa fa-play-circle-o fa-lg"></span>
     
    ffmpeg
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-book fa-lg"></span>
     
    Reference
  </a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/leonawicz/mapmate">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Make video from still image sequence</h1>
    <small class="dont-index">Source: <a href='https://github.com/leonawicz/mapmate/blob/master/R/ffmpeg.R'><code>R/ffmpeg.R</code></a></small>
    <div class="hidden name"><code>ffmpeg.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Make a video file from a sequence of still images using FFmpeg.</p>
    
    </div>

    <pre class="usage"><span class='fu'>ffmpeg</span>(<span class='kw'>dir</span> <span class='kw'>=</span> <span class='st'>"."</span>, <span class='no'>pattern</span>, <span class='no'>output</span>, <span class='kw'>output_dir</span> <span class='kw'>=</span> <span class='st'>"."</span>, <span class='kw'>rate</span> <span class='kw'>=</span> <span class='st'>"ntsc"</span>,
  <span class='kw'>delay</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>start</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>size</span> <span class='kw'>=</span> <span class='st'>"source"</span>, <span class='kw'>preset</span> <span class='kw'>=</span> <span class='st'>"ultrafast"</span>,
  <span class='kw'>codec</span> <span class='kw'>=</span> <span class='st'>"default"</span>, <span class='kw'>format</span> <span class='kw'>=</span> <span class='st'>"yuv420p"</span>, <span class='kw'>lossless</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>min.rate</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>fps.out</span> <span class='kw'>=</span> <span class='no'>rate</span>, <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>overwrite</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>glob</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>details</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>dir</th>
      <td><p>directory containing images, defaults to working directory.</p></td>
    </tr>
    <tr>
      <th>pattern</th>
      <td><p>character, for matching a set of input image files. See details for acceptable and possible alternative patterns.</p></td>
    </tr>
    <tr>
      <th>output</th>
      <td><p>character, output file name.</p></td>
    </tr>
    <tr>
      <th>output_dir</th>
      <td><p>character, output directory. Defaults to working directory.</p></td>
    </tr>
    <tr>
      <th>rate</th>
      <td><p>integer or character, intended framerate of input image sequence in Hertz (Hz) or frames per second (fps). See details.</p></td>
    </tr>
    <tr>
      <th>delay</th>
      <td><p>numeric, time delay between frames in output video. Alternative to <code>rate</code>. See details.</p></td>
    </tr>
    <tr>
      <th>start</th>
      <td><p>integer, frame to start from in input image sequence. Defaults to <code>start=1</code>.</p></td>
    </tr>
    <tr>
      <th>size</th>
      <td><p>character, the dimensions of the video output. Defaults to <code>"source"</code>, which is equal to the dimensions of the input files. Otherwise scaling is performed on the output. See details.</p></td>
    </tr>
    <tr>
      <th>preset</th>
      <td><p>character, encoding presets available in FFmpeg. Defaults to <code>ultrafast</code>. See details.</p></td>
    </tr>
    <tr>
      <th>codec</th>
      <td><p>character, the video codec used. See details.</p></td>
    </tr>
    <tr>
      <th>format</th>
      <td><p>character, the pixel format. See details.</p></td>
    </tr>
    <tr>
      <th>lossless</th>
      <td><p>logical, use lossless H.264 encoding if applicable. Defaults to <code>FALSE</code>. See details.
Set to zero if your image sequence has file names beginning from zero or a higher number if you want to skip frames.</p></td>
    </tr>
    <tr>
      <th>min.rate</th>
      <td><p>integer, the minimum frame rate for non-<code>gif</code> video output (<code>mp4</code>, <code>mov</code>, <code>mkv</code>, <code>webm</code>). Defaults to <code>10</code>. See details.</p></td>
    </tr>
    <tr>
      <th>fps.out</th>
      <td><p>integer or character, framerate of output video. This can be given in the same ways as <code>rate</code>. Defaults to <code>rate</code>. See details.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>numeric, from 0 to 1.0. Only applicable when <code>pattern</code> is vectorized, referring to layering of multiple image sequences.
Defaults to <code>1.0</code> (non-transparent) since <code>mapmate</code> produces transparent-background png sequences by default with subsequent layering in mind.</p></td>
    </tr>
    <tr>
      <th>overwrite</th>
      <td><p>logical, overwrite existing output file.</p></td>
    </tr>
    <tr>
      <th>glob</th>
      <td><p>logical, defaults to <code>FALSE</code>. Globbing is not available on Windows. Linux users, see details on how <code>glob</code> affects <code>pattern</code>.</p></td>
    </tr>
    <tr>
      <th>details</th>
      <td><p>logical, whether to show FFmpeg output on the R console.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>returns the system call to FFmpeg as a character string.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>ffmpeg</code> is a wrapper function around the popular <a href='https://www.ffmpeg.org/'>FFmpeg command line multimedia framework</a>.
It translates arguments provided by the user in familiar R syntax into a system call to the <code>ffmpeg</code> command line tool, which must be installed on the system.</p>
<p><code>ffmpeg</code> does not provide complete flexibility to allow making every possible valid call to FFmpeg,
but users who are that well versed in the use of FFmpeg can use the command line utility directly or pass their custom calls directly to <code>system</code> from within R.
The <code>ffmpeg</code> R function is primarily useful to users not well versed in the use of the FFmpeg multimedia framework who will be satisfied with the level of flexibility provided.
Since this function is provided in the context of the <code>mapmate</code> package, it is aimed at assisting with converting still image sequences to video.
While additional uses may be incorporated into <code>ffmpeg</code> in future, the FFmpeg multimedia framework itself provides a far broader suite of tools and functionality than is needed here.</p>
<p>Keep in mind that the purpose of <code>mapmate</code> is not to generate animations directly from R. See packages like <code>animation</code> if that is more the goal.
The goal that <code>mapmate</code> attempts to fulfill is strictly that of animation pre-production and it does so by focusing on the generation of still image sequences.
Any animation is expected to be done later by the user via software dedicated to video editing and production.
<code>ffmpeg</code> is provided in <code>mapmate</code> as an exception to the rule for users who wish to trade the full control and flexibility over video editing and production
that <code>mapmate</code> aims to avoid entangling itself with for the convenience of generating relatively basic video output directly from an R session.</p>
<p>Ultimately, if you want an incredibly fancy video, do not rely on <code>ffmpeg</code> to splice and merge and overlay and juxtapose all your layers together,
to crop and pan and rotate, to apply effects and transitions and every other form of video processing to your image sequences; finish the production outside of R, because that is what makes sense.
If you are an FFmpeg expert, you don't need to use <code>ffmpeg</code> at all (but perhaps consider helping to improve this code!).
If you are not an FFmpeg expert, use other video editing software.</p>
<p>There always comes a point where it makes the most sense to transition from one application to another.
When external solutions exist, it does not make sense to port the solution to every problem into R.
Future package versions may provide more and more functionality and control over video production directly from R through <code>ffmpeg</code> or other functions,
but at this time this should not be a primary development goal for <code>mapmate</code>.</p>
<h3>Input Files</h3>
    A common way to specify a set of input image files when using FFmpeg directy is to provide something like <code>myimages%04d.png</code>,
which requires specifying the entire, non-changing file name with the only substitution being for the unique, order, consecutive integer file numbering component of the file name.
The pattern used indicates how may places are occupied by the file indices, which should be constant. In this example, <code>%04d</code> represents the file numbering <code>0000, 0001, 0002, ..., 9999</code>.
If using Windows, you must use this approach. Any image sequences generated by <code>mapmate</code> will follow this kind of file naming convention.
If you want to make videos from image sequences not made by <code>mapmate</code>, they will also commonly follow this convention, but not always, in which case you will have to rename your files.
    An alternative and often convenient way to provide a general pattern for matching to a set of input files is with globbing. However, globbing is not available on Windows.
Linux users may find this additional option helpful in cases where file naming is not quite as described above or, for example, if there are multiple sequences of files in one directory.
If <code>glob=TRUE</code>, wildcards can be used in the <code>pattern</code> argument, e.g., <code>pattern="*png"</code>, <code>pattern="myimages*png"</code>, or <code>pattern="*images0*.png"</code>.
The default is <code>glob=FALSE</code> and <code>glob</code> is simply ignored on Windows.
    The current package version of <code>ffmpeg</code> allows merging more than two sequences without error,
but testing has not confirmed this is actually working correctly, as all layers do not always appear in the output video.
    <h3>Merging multiple image sequences</h3>
    <em>Merging is experimental and under development. It does not yet work as intended.</em>
    <code>pattern</code> may be a vector referring to multiple image sequences. This is for merging or blending layers into one output video file.
The first vector element refers to the top layer among image sequences.
All files do not need to be in the same directory; <code>dir</code> can be vectorized to match with <code>pattern</code> if sequences are in different locations.
Similarly, <code>rate</code>, <code>delay</code>, and <code>start</code> can be vectors. If nothing but <code>pattern</code> is a vector, the other arguments are duplicated.
Vectors should be of equal length.
    Merging capabilities are limited. An expert in the use of FFmpeg should use it directly and not via this wrapper function.
If merging sequences with this function, it is recommended they be the same number of frames, begin from the same starting frame, and proceed at the same frame rate, though this is not strictly required.
Also, merging only two sequences at a time is recommended or they may not all display.
Sequences must be very similar in a variety of respects. For example, images must be the same dimensions across sequences.
For greater control, use FFmpeg directly from the command line and consult official FFmpeg documentation, or help improve this wrapper function via Github issues and pull requests.
    Remember that <code>mapmate</code> generates still image sequences that are intended for later use in a dedicated video editing program, one with a GUI, unlike FFmpeg which is a command line application.
In such a program, it is assumed the user may be dropping multiple image sequences on different tracks of a project timeline, layering the tracks together,
and for this reason the default background png color is transparent.
In the default case, using <code>alpha</code> less than <code>1.0</code> is generally unnecessary when merging two image sequences into a video with FFmpeg.
If not using defaults, <code>alpha</code> may not provide the flexibility desired.
    <h3>Framerates</h3>
    For <code>rate</code>, non-integer numeric values are rounded. Character options may be a valid abbreviation such as <code>"ntsc"</code> or a quoted ratio such as <code>"30000/1001"</code>.
Note that this is the familiar "29.97" (or, 29.97003, to be exact) but FFmpeg does not accept values like these.
Using <code>delay</code> instead of <code>rate</code> is more limiting since <code>delay</code> is converted back to rate (\(delay=1/rate\)), but must then be rounded to an integer.
Using <code>rate</code> is recommended. Arbitrary, non-standard framerates may lead to rendered videos that do not play properly in many media players.
For common settings and character abbreviations, see <a href='http://ffmpeg.org/ffmpeg-utils.html#Video-rate'>FFmpeg standard video rates</a>.
    <code>rate</code> technically refers to the assumed or intended framerate of the input image file sequence.
This is important to mention because of the distinction between input and output framerates in FFmpeg.
See the details below on <code>min.rate</code> and <code>fps.out</code> to understand the differences and how to avoid some common problems.
    <h3>Output Scaling</h3>
    If <code>size</code> is not set to <code>"source"</code>, the output video is scaled.
<code>size</code> can be a character string of dimensions in length by height format such as <code>"720x480"</code> or an abbreviated standard such as <code>"ntsc"</code>.
See <a href='http://ffmpeg.org/ffmpeg-utils.html#Video-size'>FFmpeg standard video sizes</a> for common dimensions and available abbreviations.
    <h3>Presets, Codecs, Pixel Formats, Lossless Encoding, and minimum framerates</h3>
    Presets provide a certain encoding speed to compression ratio.
Available presets include <code>ultrafast</code>, <code>superfast</code>, <code>veryfast</code>, <code>faster</code>, <code>fast</code>, <code>medium</code>, <code>slow</code>, <code>slower</code>, <code>veryslow</code>.
Faster speed corresponds to greater file size. Slower speeds are due to greater compression.
    <code>codec</code> is ignored if the file name in <code>pattern</code> ends with <code>.gif</code>.
For other video output file types a default codec is used depending on the file extension in <code>pattern</code> when <code>codec="default"</code>.
These can be overridden with options like <code>codec="h264"</code>, <code>"libx264"</code>, <code>"libvpx"</code>, <code>"prores"</code>, <code>"qtrle"</code>, etc.,
but the user needs to be knowledgeable regarding which codecs can be used for which output types or errors will be thrown.
    <code>format</code> is ignored if the file name in <code>pattern</code> ends with <code>.gif</code>.
The default is <code>"yuv420p"</code>, which performs 4:2:0 chroma subsampling.
This pixel format can reduce video quality, but it is the default because it ensures compatibility with most media players, many of which still cannot play 4:4:4 video.
For valid alternatives, run <code>system("ffmpeg -pix_fmts")</code>.
    <code>lossless</code> is ignored except for relevant <code>codec</code> settings, e.g., <code>h264</code> or <code>libx264</code>.
If <code>TRUE</code>, recommended <code>preset</code> values are <code>ultrafast</code> or <code>veryslow</code>. See <code>https://trac.ffmpeg.org/wiki/Encode/H.264</code> for more information.
    <code>min.rate</code> applies only to non-<code>gif</code> video output. Video files typically have framerates of 25 fps or 30 fps or higher.
In the case of creating gifs from an image file sequence, low framerates on the order of 10 fps or lower, even 1 fps, are often desired.
If such a low framerate is desired for video file output, many media players may not be able to play, or play properly, such a video file.
For example, the popular VLC media player can have difficulties with playback of video files created with a framerate of less than 10 fps, particularly with rates closer to 1.
    <code>min.rate</code> sets a lower bound on the framerate of the output file.
The intended frame rate given by <code>rate</code> or derived from <code>delay</code>, of the input image file sequence specified in <code>pattern</code>,
is still preserved in the output playback. However, if <code>rate</code> is less than <code>min.rate</code>, the output file will achieve <code>min.rate</code> fps by duplicating frames.
For example, if <code>rate=1</code> and <code>min.rate=10</code>, a sequence consisting of 60 images will be converted to a 10 fps video containing 600 frames and taking the intended 60 seconds to play.
The tradeoff for compatibility with various media players is increased video file size, but depending on the codec, should not increase file size linearly,
e.g., not likely a ten times increase for the given example.
    Nevertheless, control is given to the user over the video output fps lower bound via <code>min.rate</code>. Just know that too low a value can cause problems.
If <code>rate</code> is greater than <code>min.rate</code>, the output file framerate will match the specified <code>rate</code> of the input image sequence.
This also may not be desired if <code>rate</code> is an atypical number for video framerates.
This matching can be overridden by specifying <code>fps.out</code> as something other than <code>rate</code>.
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='fu'>data</span>(<span class='no'>borders</span>)
<span class='fu'>library</span>(<span class='no'>dplyr</span>)
<span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fl'>90</span>
<span class='no'>borders</span> <span class='kw'>&lt;-</span> <span class='fu'>map</span>(<span class='fl'>1</span>:<span class='no'>n</span>, ~<span class='fu'><a href='http://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span>(<span class='no'>borders</span>, <span class='kw'>id</span> <span class='kw'>=</span> <span class='no'>.x</span>)) <span class='kw'>%&gt;%</span> <span class='fu'><a href='http://dplyr.tidyverse.org/reference/bind.html'>bind_rows</a></span>()
<span class='no'>args</span> <span class='kw'>&lt;-</span> <span class='fu'>list</span>(<span class='kw'>width</span><span class='kw'>=</span><span class='fl'>300</span>, <span class='kw'>height</span><span class='kw'>=</span><span class='fl'>300</span>, <span class='kw'>res</span><span class='kw'>=</span><span class='fl'>300</span>, <span class='kw'>bg</span><span class='kw'>=</span><span class='st'>"black"</span>)
<span class='fu'><a href='save_seq.html'>save_seq</a></span>(<span class='no'>borders</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='st'>"id"</span>, <span class='kw'>n.frames</span><span class='kw'>=</span><span class='no'>n</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='st'>"white"</span>,
         <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"maplines"</span>, <span class='kw'>file</span><span class='kw'>=</span><span class='st'>"images"</span>, <span class='kw'>png.args</span><span class='kw'>=</span><span class='no'>args</span>)
<span class='fu'>ffmpeg</span>(<span class='kw'>pattern</span><span class='kw'>=</span><span class='st'>"images_%04d.png"</span>, <span class='kw'>output</span><span class='kw'>=</span><span class='st'>"video.mp4"</span>, <span class='kw'>rate</span><span class='kw'>=</span><span class='fl'>10</span>)
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Matthew Leonawicz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

